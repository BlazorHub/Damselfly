# Installing Damselfly

[Return to Readme](../README.md)

- [Installing Damselfly](#installing-damselfly)
  - [Docker](#docker)
    - [Docker Command:](#docker-command)
    - [Docker-Compose:](#docker-compose)

## Docker

The easiest way to install Damselfly is via Docker. Mount your photos folder as the /pictures volume, and a config 
folder (in which the database, thumbnails etc will be stored), and you're ready to go.

### Docker Command:
```
docker run \
  --name damselfly \
  --restart unless-stopped \
  -v /volume1/dockerdata/damselfly:/config \
  -v /volume1/photo:/pictures \
  -v /volume1/dockerdata/damselfly/thumbs:/thumbs \
  -p 6363:6363 \
  -d \
  webreaper/damselfly
```

**_Note:_** If you're running on a Synology NAS, and have the Synology indexing/thumbnails enabled, you can specify `-e SYNO_THUMBS=true` which will make Damselfly use the same `@eaDir` folder structure as Synology's indexing system, which means that thumbnails already generated will be used by Damselfly (and Damselfly's thumbnails will be used by Synology Photo Station).

### Docker-Compose: 
```
 damselfly: 
        container_name: damselfly
        image: webreaper/damselfly
        ports:
            - 6363:6363/tcp
        volumes:
            - /volume1/dockerdata/damselfly:/config
            - /volume1/dockerdata/damselfly/thumbs:/thumbs
            - /volume1/photo:/pictures 
        restart: unless-stopped
```

The default port is 6363. The /pictures volume is mapped to the root directory of your photographs. 

Note that in order to set up inotify watchers on your folders, you may need to increase the number of inotify instances as follows (where 524288 is any large number that's big enough for one watcher per folder):

```
echo fs.inotify.max_user_instances=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p
```

Other options:
`SYNO_THUMBS=True` - Tells Damselfly to use existing Synology thumbnails (which are generated by DSM's indexing process) and to generate new thumbs in the same format.
